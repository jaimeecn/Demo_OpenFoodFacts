{% extends 'core/base.html' %}

{% block content %}
<div class="container py-5">
    <div class="row">
        <div class="col-md-8">
            <h1 class="mb-3 fw-bold">{{ receta.titulo }}</h1>
            
            <div class="d-flex gap-2 mb-4 flex-wrap">
                <span class="badge bg-dark p-2">‚è± {{ receta.tiempo_preparacion }} min</span>
                {% if receta.es_apta_horno %}<span class="badge bg-warning text-dark p-2">Horno</span>{% endif %}
                {% if receta.es_apta_sarten %}<span class="badge bg-secondary p-2">Sart√©n</span>{% endif %}
                {% if receta.es_apta_airfryer %}<span class="badge bg-info text-dark p-2">Airfryer</span>{% endif %}
                {% if receta.es_apta_tupper %}<span class="badge bg-success p-2">Apta Tupper</span>{% endif %}
            </div>

            <div class="card mb-4 bg-light border-0">
                <div class="card-body">
                    <h5 class="card-title text-muted mb-3">Informaci√≥n Nutricional (por raci√≥n)</h5>
                    <div class="row text-center">
                        <div class="col">
                            <div class="h3 mb-0">{{ receta.calorias }}</div>
                            <small class="text-muted">Kcal</small>
                        </div>
                        <div class="col">
                            <div class="h3 mb-0 text-primary">{{ receta.proteinas }}g</div>
                            <small class="text-muted">Prote√≠nas</small>
                        </div>
                        <div class="col">
                            <div class="h3 mb-0 text-warning">{{ receta.grasas }}g</div>
                            <small class="text-muted">Grasas</small>
                        </div>
                        <div class="col">
                            <div class="h3 mb-0 text-success">{{ receta.hidratos }}g</div>
                            <small class="text-muted">Hidratos</small>
                        </div>
                    </div>
                </div>
            </div>

            <h4 class="mb-3">Ingredientes</h4>
            <ul class="list-group list-group-flush mb-4">
                {% for ing in receta.ingredientes.all %}
                <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                    <span>{{ ing.ingrediente_base.nombre }}</span>
                    <span class="badge bg-light text-dark border">{{ ing.cantidad_gramos }}g</span>
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm border-primary mb-3">
                <div class="card-header bg-primary text-white fw-bold">
                    üí∞ Comparador de Costes
                </div>
                <ul class="list-group list-group-flush">
                    {% for coste in costes %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        <span class="fw-bold" style="color: {{ coste.supermercado.color_brand }}">
                            {{ coste.supermercado.nombre }}
                        </span>
                        <span class="fs-5">{{ coste.coste|floatformat:2 }}‚Ç¨</span>
                    </li>
                    {% empty %}
                    <li class="list-group-item text-muted">
                        Faltan ingredientes en los supermercados registrados.
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}